////////////////////////////////////////////////////////////////////////
// Module:				Blitzprog.GUI.Linux
// Author:				Eduard Urbach
// Description:			Graphical user interface
////////////////////////////////////////////////////////////////////////

#ifndef BLITZPROG_GUI_LINUX_HPP_
#define BLITZPROG_GUI_LINUX_HPP_

////////////////////////////////////////////////////////////////////////
// Includes
////////////////////////////////////////////////////////////////////////

//Modules
#include <Blitzprog/header.hpp>
#include <Blitzprog/Core/Core.hpp>
#include <Blitzprog/Thread/Thread.hpp>

//GTK
#include <gtk/gtk.h>
#include <gdk/gdk.h>

//X11
#include <X11/keysym.h>

////////////////////////////////////////////////////////////////////////
// Variables
////////////////////////////////////////////////////////////////////////



////////////////////////////////////////////////////////////////////////
// Functions
////////////////////////////////////////////////////////////////////////

//InitXKeyMap
void InitXKeyMap();

//GUIMain
void GUIMain();

////////////////////////////////////////////////////////////////////////
// Inline functions
////////////////////////////////////////////////////////////////////////

//PollSystem
inline void PollSystem()
{
	gdk_threads_enter();
	//gtk_main_iteration_do(false);
	while(gtk_events_pending())
		gtk_main_iteration();
	gdk_threads_leave();
}

//ScreenWidth
inline int ScreenWidth()
{
	return gdk_screen_width();
}

//ScreenHeight
inline int ScreenHeight()
{
	return gdk_screen_height();
}

////////////////////////////////////////////////////////////////////////
// Classes
////////////////////////////////////////////////////////////////////////

//GUIStartUp
class GUIStartUp
{
	public:
		static bool bpGtkInitialized;
		
		//Constructor
		GUIStartUp() : systemThread(CreateThread(GUIMain))
		{
			Delay(10);
			while(!bpGtkInitialized)
			{
				Delay(10);
			}
		}
	
	protected:
		Thread systemThread;
};

#ifndef BLITZPROG_LIB
	static GUIStartUp GUIStartUpObject;
	bool GUIStartUp::bpGtkInitialized = 0;
#endif

////////////////////////////////////////////////////////////////////////
// Constants
////////////////////////////////////////////////////////////////////////


//Widgets
#include <Blitzprog/GUI/Window/Window.Linux.hpp>
#include <Blitzprog/GUI/Button/Button.Linux.hpp>

#endif /*BLITZPROG_GUI_LINUX_HPP_*/
